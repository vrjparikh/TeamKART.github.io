function datetoNumber(e){return p=e.getDate(),q=e.getMonth()+1,r=e.getFullYear(),r+""+(10>q?"0":"")+(q+"")+(10>p?"0":"")+(p+"")}function checkCookie(e){var t=getCookie(e);return""!=t?t:-1}function setCookie(e,t,n){var i=new Date;i.setTime(i.getTime()+365*n*24*60*60*1e3),document.cookie=e+"="+t+"; expires="+i.toGMTString()+"; path=/"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){var a=n[i].trim();if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""}function progress(){$("#progress").css("opacity","1")}function done(){$("#progress").css("opacity","0"),$("#errorMessage").html("You are now subscribed"),setTimeout(function(){$('button[title="Close (Esc)"').click()},2e3)}function fail(e){$("#progress").css("opacity","0"),$("#errorMessage").html(e?"Please check your connection":"Captcha Error")}function loadData(){popup=checkCookie("popup"),-1===popup&&(popup="false",setCookie("popup",popup,10)),last=checkCookie("last"),-1===last&&(d=new Date,d.getTime(),last=datetoNumber(d)-4+"",setCookie("last",last,10))}function onLaunch(){if(loadData(),"true"!=popup){if($("#hidePopupCheck").prop("checked",!1),d=new Date,d.getTime(),d=datetoNumber(d),3>d-last)return;setTimeout(function(){popupSubscribe()},5e3)}else $("#hidePopupCheck").prop("checked",!0)}function popupBlock(){popup=document.getElementById("hidePopupCheck").checked+"",setCookie("popup",popup,10)}function popupSubscribe(){$("#sub-super").click(),d=new Date,d.getTime(),last=datetoNumber(d),setCookie("last",last,10)}var popup,last;$(document).ready(function(){onLaunch(),$("#subForm").on("submit",function(e){e.preventDefault(),progress();var t={email:$("#subEmail").val(),captcha:$("#g-recaptcha-response").val()};$.ajax({type:"POST",url:"/message/",data:t,success:function(e){0==e?done():fail(!1)},error:function(){fail(!0)}})})});